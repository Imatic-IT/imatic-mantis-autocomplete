!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function r(e,t){return e[t]}n.r(t);let o={};let i;function c(){const e=document.querySelector("#imaticAutocompleteWidget");e&&(i(),e.remove())}function l(){const e=document.querySelector("#imaticAutocompleteWidget");e&&e.focus()}function s(e){let t=!1,n=0,s=null;function u(){t&&(t=!1,c())}function a(){return e.selectionStart-n}function d(){const t=a(),r=e.value.substr(n,t);return 0===r.length||null!=r.match(/[\n ]/)?null:r}const f=()=>{if(0!==e.selectionStart){if("@"===e.value[e.selectionStart-1])return t=!0,n=e.selectionStart,void(s=null);if(t){const l=d();if(null==l)return void u();const f=()=>{const l=function(e,t){for(let n=t.length;n>0;n--){const o=r(e,t.substr(0,n));if(null!=o)return o}}(o,d());if(null==l||0===l.length||!t)return c(),void(s=null);if(function(e,t){if(null==e||null==t)return null==e&&null==t;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(s,l))return;const u=a();s=l,function({completions:e,onSelect:t,focusInput:n,onRestyle:r,input:o}){c();let l=0;const s=e.map(e=>{const t=document.createTextNode(e),n=document.createElement("li");return n.setAttribute("tabindex",-1),n.appendChild(t),n}),u=document.createElement("ul");u.className="imatic-autocomplete",u.setAttribute("id","imaticAutocompleteWidget"),u.setAttribute("tabindex",-1),s.forEach(e=>u.appendChild(e));const a=new Set(["ArrowDown","ArrowUp","Enter","Tab"]);u.addEventListener("keydown",r=>{if(a.has(r.code))switch(r.preventDefault(),r.code){case"ArrowUp":{const e=u.querySelector(`li:nth-child(${l})`);e?(l--,e.focus()):n();break}case"ArrowDown":{const e=u.querySelector(`li:nth-child(${l+2})`);e&&(l++,e.focus())}break;case"Enter":if(t){function o(e){return e.replace(/.*\s/,"")}const n=o(e[l]);t({val:n}),c()}break;case"Tab":if(r.preventDefault(),t){function o(e){return e.replace(/.*\s/,"")}const n=o(e[l]);t({val:n}),c()}}}),u.addEventListener("click",e=>{var n=$(e.target).text();n=n.replace(/.*\s/,""),t({val:n}),c()}),u.addEventListener("focus",e=>{const t=u.querySelector("li");l=0,t&&t.focus()});const d=()=>r(u),f=e=>{e.target===o||e.target===u||u.contains(e.target)||c()},p=o.closest(".table-responsive");var m=document.getElementById("bugnote_text");m.addEventListener("input",d),m.addEventListener("click",d),m.addEventListener("resize",d),window.addEventListener("scroll",d),window.addEventListener("resize",d),o.addEventListener("scroll",d),p&&p.addEventListener("scroll",d),window.addEventListener("click",f),window.addEventListener("focusin",f),i=()=>{m.removeEventListener("input",d),m.removeEventListener("click",d),m.removeEventListener("resize",d),window.removeEventListener("scroll",d),window.removeEventListener("resize",d),o.removeEventListener("scroll",d),p&&p.removeEventListener("scroll",d),window.removeEventListener("click",f),window.removeEventListener("focusin",f)},document.body.appendChild(u),d()}({completions:l,input:e,focusInput:()=>{const t=n+u;e.focus(),e.setSelectionRange(t,t)},onSelect:({val:r})=>{if(!t)return;const o=n+u,i=n+d().length;e.focus(),e.setRangeText(r.substr(u)+" ",o,i,"end"),t=!1},onRestyle:t=>{const n=e.getBoundingClientRect(),r=getComputedStyle(e);let o=document.getElementById("imaticAutocompleteWidget");const i=function(e,t){const n=document.createElement("span");n.textContent=t;const r=document.createElement("div");r.appendChild(n),Array.from(e).forEach((function(t){r.style.setProperty(t,e.getPropertyValue(t),e.getPropertyPriority(t))})),r.style.visibility="hidden",document.body.appendChild(r);const o={width:n.offsetWidth,height:n.offsetHeight};return r.remove(),o}(r,e.value.substr(0,e.selectionStart)).height;if(t.style.position="fixed",t.style.left=Math.max(0,n.x)+"px",t.style.top=n.y+i+5-e.scrollTop+"px",t.style.width=e.clientWidth+"px",o&&i){const r=o.getBoundingClientRect(),c=n.y-r.y+i;c>-5&&(t.style.top=n.y+i+10-e.scrollTop+c+"px")}}})};if(null!=r(o,l))return f(r(o,l));let p=document.querySelectorAll('select[name="handler_id"]'),m=[];for(let e=0;e<p.length;e++){let t=p[e].options;for(let e=0;e<t.length;e++)m.push(t[e].textContent)}m=m.filter((function(e){return"[Myself]"!==e&&"[Reporter]"!==e})),function(e,t){let n=t.filter((function(t){if(0===t.replace(/.*\s/,"").indexOf(e))return t.includes(e)}));o=function(e,t,n){return Object.assign({},e,{[t]:n})}(o,e,n),f()}(l,m)}}else u()};e.addEventListener("keydown",r=>{if(t){switch(r.code){case"ArrowDown":r.preventDefault(),l();break;case"ArrowUp":u();break;case"ArrowLeft":case"ArrowRight":setTimeout(()=>f(),0);break;case"Tab":{if(r.preventDefault(),!t)return;l();const o=a(),i=document.querySelector("#imaticAutocompleteWidget").firstChild;if(i){const r=i.textContent.replace(/.*\s/,""),l=n+o,s=n+d().length;e.focus(),e.setRangeText(r.substr(o)+" ",l,s,"end"),c(),t=!1}}}"ArrowDown"===r.code&&l()}}),e.addEventListener("input",e=>{f()})}document.querySelectorAll("#bugnote_text, #description, #steps_to_reproduce, #additional_info, #summary, #additional_information").forEach(e=>{s(e)})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vanMvY2FjaGUuanMiLCJ3ZWJwYWNrOi8vLy4vanMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vanMvdXRpbHMuanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJjYWNoZSIsInRlcm0iLCJyZXN1bHRDYWNoZSIsImRlc3Ryb3lMaXN0Rm4iLCJjbG9zZUF1dG9jb21wbGV0ZUxpc3RFbCIsImVsIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicmVtb3ZlIiwiZm9jdXNBdXRvY29tcGxldGVMaXN0IiwiZm9jdXMiLCJhdXRvY29tcGxldGUiLCJhdXRvY29tcGxldGluZyIsInN0YXJ0U2VsIiwiYWN0aXZlQ29tcGxldGlvbnMiLCJzdG9wQXV0b2NvbXBsZXRlIiwiZ2V0U2VsZWN0aW9uTGVuZ3RoIiwic2VsZWN0aW9uU3RhcnQiLCJnZXRTZWxlY3Rpb24iLCJsZW4iLCJzZWxlY3Rpb24iLCJzdWJzdHIiLCJsZW5ndGgiLCJtYXRjaCIsImhhbmRsZUNoYW5nZSIsInYiLCJyZWNlaXZlQ29tcGxldGlvbnMiLCJjb21wbGV0aW9ucyIsInJlcyIsInYxIiwidjIiLCJmbGF0QXJyYXlzRXF1YWwiLCJvblNlbGVjdCIsImZvY3VzSW5wdXQiLCJvblJlc3R5bGUiLCJpbnB1dCIsImZvY3VzZWQiLCJjb21wbGV0aW9uRWxzIiwibWFwIiwidGV4dCIsImNyZWF0ZVRleHROb2RlIiwibGkiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiYXBwZW5kQ2hpbGQiLCJ1bCIsImNsYXNzTmFtZSIsImZvckVhY2giLCJjb250cm9sS2V5cyIsIlNldCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiaGFzIiwiY29kZSIsInByZXZlbnREZWZhdWx0IiwibmV3QWN0aXZlIiwicmVtb3ZlSWNvbkZyb21OYW1lIiwibmFtZVdpdGhJY29uIiwicmVwbGFjZSIsIm5hbWVXaXRob3V0SWNvbiIsInZhbCIsIiQiLCJ0YXJnZXQiLCJmaXJzdExpIiwicmVzdHlsZSIsImNsb3NlSWZPdXRzaWRlVGFyZ2V0IiwiY29udGFpbnMiLCJzY0NvbnRhaW5lciIsImNsb3Nlc3QiLCJ0ZXh0QXJlYSIsImdldEVsZW1lbnRCeUlkIiwid2luZG93IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImJvZHkiLCJvcGVuQXV0b2NvbXBsZXRlTGlzdEVsIiwicmVxdWlyZWRTZWwiLCJzZXRTZWxlY3Rpb25SYW5nZSIsInJlcGxhY2VUbyIsInNldFJhbmdlVGV4dCIsImxpc3RFbCIsImxpc3RQb3MiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJlbFN0eWxlcyIsImdldENvbXB1dGVkU3R5bGUiLCJ3aWRnZXRJZCIsInRleHRIZWlnaHQiLCJjb21wdXRlZFN0eWxlIiwic3BhbiIsInRleHRDb250ZW50IiwiZGl2IiwiQXJyYXkiLCJmcm9tIiwic3R5bGUiLCJzZXRQcm9wZXJ0eSIsImdldFByb3BlcnR5VmFsdWUiLCJnZXRQcm9wZXJ0eVByaW9yaXR5IiwidmlzaWJpbGl0eSIsImRhdGEiLCJ3aWR0aCIsIm9mZnNldFdpZHRoIiwiaGVpZ2h0Iiwib2Zmc2V0SGVpZ2h0IiwicG9zaXRpb24iLCJsZWZ0IiwiTWF0aCIsIm1heCIsIngiLCJ0b3AiLCJ5Iiwic2Nyb2xsVG9wIiwiY2xpZW50V2lkdGgiLCJ3aWRnZXRQb3NpdGlvbiIsInBvc0RpZiIsImhhbmRsZXJzU2VsZWN0IiwicXVlcnlTZWxlY3RvckFsbCIsIm9wdGlvbnMiLCJqIiwicHVzaCIsImZpbHRlciIsImhhbmRsZXIiLCJ1c2VycyIsImZpbHRlcmVkVXNlcnMiLCJ1c2VyIiwiaW5kZXhPZiIsImluY2x1ZGVzIiwiYXNzaWduIiwiZmlsdGVyVXNlcnNCeVN0cmluZyIsInNldFRpbWVvdXQiLCJmaXJzdENoaWxkIiwidGV4dFZhbHVlIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdB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T0FBTyxHQUFJN0gsRUFBTyxDQUFDLENBQUNDLEdBQU9oQixJQ21WZixDQUFVaUIsRUFBYXVCLEVBQUdnRyxHQUN4Qy9GLElBYkpvRyxDQUFvQnJHLEVBQUdFLFNBL0d2QlosS0FpSVJWLEVBQUc2QyxpQkFBaUIsVUFBWUMsSUFDNUIsR0FBS3ZDLEVBQUwsQ0FJQSxPQUFRdUMsRUFBRUUsTUFDTixJQUFLLFlBQ0RGLEVBQUVHLGlCQUNGN0MsSUFDQSxNQUNKLElBQUssVUFDRE0sSUFDQSxNQUNKLElBQUssWUFDTCxJQUFLLGFBRURnSCxXQUFXLElBQU12RyxJQUFnQixHQUNqQyxNQUNKLElBQUksTUFBTyxDQUVQLEdBREEyQixFQUFFRyxrQkFDRzFDLEVBQ0QsT0FFSkgsSUFFQSxNQUFNVSxFQUFNSCxJQUNOZ0gsRUFBYTFILFNBQVNDLGNBQWMsNkJBQTZCeUgsV0FFdkUsR0FBSUEsRUFBWSxDQUVaLE1BQU1DLEVBQVlELEVBQVd4QyxZQUFZOUIsUUFBUSxPQUFRLElBRW5EaUIsRUFBYzlELEVBQVdNLEVBQ3pCMEQsRUFBWWhFLEVBQVdLLElBQWVJLE9BRTVDakIsRUFBR0ssUUFDSEwsRUFBR3lFLGFBQ0NtRCxFQUFVNUcsT0FBT0YsR0FBTyxJQUN4QndELEVBQ0FFLEVBQ0EsT0FFSnpFLElBRUFRLEdBQWlCLElBS2QsY0FBWHVDLEVBQUVFLE1BQ0Y1QyxPQUdSSixFQUFHNkMsaUJBQWlCLFFBQVVDLElBQzFCM0IsTUFLUmxCLFNBQ0s0RyxpQkFDRyx5R0FFSG5FLFFBQVMxQyxJQUNOTSxFQUFhTiIsImZpbGUiOiJhdXRvY29tcGxldGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJleHBvcnQgZnVuY3Rpb24gY3JlYXRlKCkge1xuICAgIHJldHVybiB7fTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldChjYWNoZSwgdGVybSwgdmFsdWUpIHtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgY2FjaGUsIHtbdGVybV06IHZhbHVlfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXQoY2FjaGUsIHRlcm0pIHtcbiAgICByZXR1cm4gY2FjaGVbdGVybV07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXMoY2FjaGUsIHRlcm0pIHtcbiAgICByZXR1cm4gZ2V0KGNhY2hlLCB0ZXJtKSAhPSBudWxsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmVzdE1hdGNoKGNhY2hlLCB0ZXJtKSB7XG4gICAgZm9yIChsZXQgaSA9IHRlcm0ubGVuZ3RoOyBpID4gMDsgaS0tKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IGdldChjYWNoZSwgdGVybS5zdWJzdHIoMCwgaSkpO1xuICAgICAgICBpZiAocmVzICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgKiBhcyB1IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0ICogYXMgY2FjaGUgZnJvbSAnLi9jYWNoZSc7XG5cbmxldCByZXN1bHRDYWNoZSA9IGNhY2hlLmNyZWF0ZSgpO1xuY29uc3QgbWF4X2xlbiA9IDE5MTtcbmxldCBkZXN0cm95TGlzdEZuO1xuXG5mdW5jdGlvbiBmbGF0QXJyYXlzRXF1YWwodjEsIHYyKSB7XG4gICAgaWYgKHYxID09IG51bGwgfHwgdjIgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdjEgPT0gbnVsbCAmJiB2MiA9PSBudWxsO1xuICAgIH1cblxuICAgIGlmICh2MS5sZW5ndGggIT09IHYyLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2MS5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAodjFbaV0gIT09IHYyW2ldKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gb3BlbkF1dG9jb21wbGV0ZUxpc3RFbCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNJbnB1dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uUmVzdHlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSB7XG4gICAgY2xvc2VBdXRvY29tcGxldGVMaXN0RWwoKTtcblxuICAgIGxldCBmb2N1c2VkID0gMDtcblxuICAgIGNvbnN0IGNvbXBsZXRpb25FbHMgPSBjb21wbGV0aW9ucy5tYXAoKHYpID0+IHtcbiAgICAgICAgY29uc3QgdGV4dCA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHYpO1xuXG4gICAgICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAgICAgbGkuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIC0xKTtcbiAgICAgICAgbGkuYXBwZW5kQ2hpbGQodGV4dCk7XG5cbiAgICAgICAgcmV0dXJuIGxpO1xuICAgIH0pO1xuXG4gICAgY29uc3QgdWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xuICAgIHVsLmNsYXNzTmFtZSA9ICdpbWF0aWMtYXV0b2NvbXBsZXRlJztcbiAgICB1bC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2ltYXRpY0F1dG9jb21wbGV0ZVdpZGdldCcpO1xuICAgIHVsLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAtMSk7XG4gICAgY29tcGxldGlvbkVscy5mb3JFYWNoKChlbCkgPT4gdWwuYXBwZW5kQ2hpbGQoZWwpKTtcblxuICAgIGNvbnN0IGNvbnRyb2xLZXlzID0gbmV3IFNldChbJ0Fycm93RG93bicsICdBcnJvd1VwJywgJ0VudGVyJywgJ1RhYiddKTtcblxuICAgIHVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4ge1xuICAgICAgICBpZiAoIWNvbnRyb2xLZXlzLmhhcyhlLmNvZGUpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7IC8vIHByZXZlbnQgc2Nyb2xsaW5nXG5cbiAgICAgICAgc3dpdGNoIChlLmNvZGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ0Fycm93VXAnOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3QWN0aXZlID0gdWwucXVlcnlTZWxlY3RvcihgbGk6bnRoLWNoaWxkKCR7Zm9jdXNlZH0pYCk7XG4gICAgICAgICAgICAgICAgaWYgKG5ld0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICBmb2N1c2VkLS07XG4gICAgICAgICAgICAgICAgICAgIG5ld0FjdGl2ZS5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvY3VzSW5wdXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdBcnJvd0Rvd24nOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3QWN0aXZlID0gdWwucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgICAgICAgYGxpOm50aC1jaGlsZCgke2ZvY3VzZWQgKyAyfSlgXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBpZiAobmV3QWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvY3VzZWQrKztcbiAgICAgICAgICAgICAgICAgICAgbmV3QWN0aXZlLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnRW50ZXInOiB7XG4gICAgICAgICAgICAgICAgaWYgKG9uU2VsZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHJlbW92ZUljb25Gcm9tTmFtZShuYW1lV2l0aEljb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuYW1lV2l0aEljb24ucmVwbGFjZSgvLipcXHMvLCBcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVXaXRob3V0SWNvbiA9IHJlbW92ZUljb25Gcm9tTmFtZShjb21wbGV0aW9uc1tmb2N1c2VkXSk7XG4gICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0KHt2YWw6IG5hbWVXaXRob3V0SWNvbn0pO1xuICAgICAgICAgICAgICAgICAgICBjbG9zZUF1dG9jb21wbGV0ZUxpc3RFbCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ1RhYic6IHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICAgICAgICBpZiAob25TZWxlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcmVtb3ZlSWNvbkZyb21OYW1lKG5hbWVXaXRoSWNvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5hbWVXaXRoSWNvbi5yZXBsYWNlKC8uKlxccy8sIFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZVdpdGhvdXRJY29uID0gcmVtb3ZlSWNvbkZyb21OYW1lKGNvbXBsZXRpb25zW2ZvY3VzZWRdKTtcbiAgICAgICAgICAgICAgICAgICAgb25TZWxlY3Qoe3ZhbDogbmFtZVdpdGhvdXRJY29ufSk7XG4gICAgICAgICAgICAgICAgICAgIGNsb3NlQXV0b2NvbXBsZXRlTGlzdEVsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICB1bC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIHZhciB0ZXh0ID0gJChlLnRhcmdldCkudGV4dCgpO1xuICAgICAgICAvLyBSZW1vdmUgcm9sZSBpY29uXG4gICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoLy4qXFxzLywgXCJcIik7XG4gICAgICAgIG9uU2VsZWN0KHt2YWw6IHRleHR9KTtcbiAgICAgICAgY2xvc2VBdXRvY29tcGxldGVMaXN0RWwoKTtcbiAgICB9KVxuXG4gICAgdWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCAoZSkgPT4ge1xuICAgICAgICBjb25zdCBmaXJzdExpID0gdWwucXVlcnlTZWxlY3RvcignbGknKTtcbiAgICAgICAgZm9jdXNlZCA9IDA7XG4gICAgICAgIGlmIChmaXJzdExpKSB7XG4gICAgICAgICAgICBmaXJzdExpLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3R5bGUgPSAoKSA9PiBvblJlc3R5bGUodWwpO1xuXG4gICAgY29uc3QgY2xvc2VJZk91dHNpZGVUYXJnZXQgPSAoZSkgPT4ge1xuICAgICAgICBpZiAoZS50YXJnZXQgPT09IGlucHV0IHx8IGUudGFyZ2V0ID09PSB1bCB8fCB1bC5jb250YWlucyhlLnRhcmdldCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNsb3NlQXV0b2NvbXBsZXRlTGlzdEVsKCk7XG4gICAgfTtcblxuICAgIGNvbnN0IHNjQ29udGFpbmVyID0gaW5wdXQuY2xvc2VzdCgnLnRhYmxlLXJlc3BvbnNpdmUnKTtcblxuICAgIHZhciB0ZXh0QXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidWdub3RlX3RleHQnKVxuXG4gICAgdGV4dEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCByZXN0eWxlKTtcbiAgICB0ZXh0QXJlYS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHJlc3R5bGUpO1xuICAgIHRleHRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHJlc3R5bGUpO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHJlc3R5bGUpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXN0eWxlKTtcbiAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCByZXN0eWxlKTtcbiAgICBpZiAoc2NDb250YWluZXIpIHtcbiAgICAgICAgc2NDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgcmVzdHlsZSk7XG4gICAgfVxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlSWZPdXRzaWRlVGFyZ2V0KTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNpbicsIGNsb3NlSWZPdXRzaWRlVGFyZ2V0KTtcblxuICAgIGRlc3Ryb3lMaXN0Rm4gPSAoKSA9PiB7XG5cbiAgICAgICAgdGV4dEFyZWEucmVtb3ZlRXZlbnRMaXN0ZW5lcignaW5wdXQnLCByZXN0eWxlKTtcbiAgICAgICAgdGV4dEFyZWEucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZXN0eWxlKTtcbiAgICAgICAgdGV4dEFyZWEucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgcmVzdHlsZSk7XG5cbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHJlc3R5bGUpO1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgcmVzdHlsZSk7XG4gICAgICAgIGlucHV0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHJlc3R5bGUpO1xuICAgICAgICBpZiAoc2NDb250YWluZXIpIHtcbiAgICAgICAgICAgIHNjQ29udGFpbmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHJlc3R5bGUpO1xuICAgICAgICB9XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlSWZPdXRzaWRlVGFyZ2V0KTtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCBjbG9zZUlmT3V0c2lkZVRhcmdldCk7XG4gICAgfTtcblxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodWwpO1xuXG4gICAgcmVzdHlsZSgpO1xufVxuXG5mdW5jdGlvbiBjbG9zZUF1dG9jb21wbGV0ZUxpc3RFbCgpIHtcbiAgICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNpbWF0aWNBdXRvY29tcGxldGVXaWRnZXQnKTtcbiAgICBpZiAoZWwpIHtcbiAgICAgICAgZGVzdHJveUxpc3RGbigpO1xuICAgICAgICBlbC5yZW1vdmUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGZvY3VzQXV0b2NvbXBsZXRlTGlzdCgpIHtcbiAgICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNpbWF0aWNBdXRvY29tcGxldGVXaWRnZXQnKTtcbiAgICBpZiAoIWVsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBlbC5mb2N1cygpO1xufVxuXG5mdW5jdGlvbiBhdXRvY29tcGxldGUoZWwpIHtcbiAgICBsZXQgYXV0b2NvbXBsZXRpbmcgPSBmYWxzZTtcbiAgICBsZXQgc3RhcnRTZWwgPSAwO1xuICAgIGxldCBhY3RpdmVDb21wbGV0aW9ucyA9IG51bGw7XG5cbiAgICBmdW5jdGlvbiBzdG9wQXV0b2NvbXBsZXRlKCkge1xuICAgICAgICBpZiAoIWF1dG9jb21wbGV0aW5nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBhdXRvY29tcGxldGluZyA9IGZhbHNlO1xuICAgICAgICBjbG9zZUF1dG9jb21wbGV0ZUxpc3RFbCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFNlbGVjdGlvbkxlbmd0aCgpIHtcbiAgICAgICAgcmV0dXJuIGVsLnNlbGVjdGlvblN0YXJ0IC0gc3RhcnRTZWw7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U2VsZWN0aW9uKCkge1xuICAgICAgICBjb25zdCBsZW4gPSBnZXRTZWxlY3Rpb25MZW5ndGgoKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWwudmFsdWUuc3Vic3RyKHN0YXJ0U2VsLCBsZW4pO1xuXG4gICAgICAgIGlmIChzZWxlY3Rpb24ubGVuZ3RoID09PSAwIHx8IHNlbGVjdGlvbi5tYXRjaCgvW1xcbiBdLykgIT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc2VsZWN0aW9uO1xuICAgIH1cblxuICAgIGNvbnN0IGhhbmRsZUNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgaWYgKGVsLnNlbGVjdGlvblN0YXJ0ID09PSAwKSB7XG4gICAgICAgICAgICBzdG9wQXV0b2NvbXBsZXRlKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZWwudmFsdWVbZWwuc2VsZWN0aW9uU3RhcnQgLSAxXSA9PT0gJ0AnKSB7XG4gICAgICAgICAgICBhdXRvY29tcGxldGluZyA9IHRydWU7XG4gICAgICAgICAgICBzdGFydFNlbCA9IGVsLnNlbGVjdGlvblN0YXJ0O1xuICAgICAgICAgICAgYWN0aXZlQ29tcGxldGlvbnMgPSBudWxsO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGF1dG9jb21wbGV0aW5nKSB7XG4gICAgICAgICAgICBjb25zdCB2ID0gZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICBpZiAodiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgc3RvcEF1dG9jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgcmVjZWl2ZUNvbXBsZXRpb25zID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbXBsZXRpb25zID0gY2FjaGUuZ2V0QmVzdE1hdGNoKFxuICAgICAgICAgICAgICAgICAgICByZXN1bHRDYWNoZSxcbiAgICAgICAgICAgICAgICAgICAgZ2V0U2VsZWN0aW9uKClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGlvbnMgPT0gbnVsbCB8fFxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9ucy5sZW5ndGggPT09IDAgfHxcbiAgICAgICAgICAgICAgICAgICAgIWF1dG9jb21wbGV0aW5nXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsb3NlQXV0b2NvbXBsZXRlTGlzdEVsKCk7XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUNvbXBsZXRpb25zID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChmbGF0QXJyYXlzRXF1YWwoYWN0aXZlQ29tcGxldGlvbnMsIGNvbXBsZXRpb25zKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgbGVuID0gZ2V0U2VsZWN0aW9uTGVuZ3RoKCk7XG4gICAgICAgICAgICAgICAgYWN0aXZlQ29tcGxldGlvbnMgPSBjb21wbGV0aW9ucztcblxuICAgICAgICAgICAgICAgIG9wZW5BdXRvY29tcGxldGVMaXN0RWwoe1xuICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9uczogY29tcGxldGlvbnMsXG4gICAgICAgICAgICAgICAgICAgIGlucHV0OiBlbCxcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNJbnB1dDogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVxdWlyZWRTZWwgPSBzdGFydFNlbCArIGxlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbC5zZXRTZWxlY3Rpb25SYW5nZShyZXF1aXJlZFNlbCwgcmVxdWlyZWRTZWwpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvblNlbGVjdDogKHt2YWx9KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWF1dG9jb21wbGV0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXF1aXJlZFNlbCA9IHN0YXJ0U2VsICsgbGVuO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVwbGFjZVRvID0gc3RhcnRTZWwgKyBnZXRTZWxlY3Rpb24oKS5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbC5zZXRSYW5nZVRleHQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsLnN1YnN0cihsZW4pICsgJyAnLCAvLyAnICcgd2hpdGVzcGFjZSBhZnRlciBpbnNlcnRlZCBAdXNlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkU2VsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VUbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZW5kJ1xuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9jb21wbGV0aW5nID0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb25SZXN0eWxlOiAobGlzdEVsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaXN0UG9zID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbFN0eWxlcyA9IGdldENvbXB1dGVkU3R5bGUoZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHdpZGdldElkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ltYXRpY0F1dG9jb21wbGV0ZVdpZGdldCcpXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRleHRIZWlnaHQgPSB1LnRleHRTaXplKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsU3R5bGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsLnZhbHVlLnN1YnN0cigwLCBlbC5zZWxlY3Rpb25TdGFydClcbiAgICAgICAgICAgICAgICAgICAgICAgICkuaGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0RWwuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdEVsLnN0eWxlLmxlZnQgPSBNYXRoLm1heCgwLCBsaXN0UG9zLngpICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RFbC5zdHlsZS50b3AgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RQb3MueSArIHRleHRIZWlnaHQgKyA1IC0gZWwuc2Nyb2xsVG9wICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RFbC5zdHlsZS53aWR0aCA9IGVsLmNsaWVudFdpZHRoICsgJ3B4JztcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdpZGdldElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRleHRIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2lkZ2V0UG9zaXRpb24gPSB3aWRnZXRJZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcG9zRGlmID0gbGlzdFBvcy55IC0gd2lkZ2V0UG9zaXRpb24ueSArIHRleHRIZWlnaHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvc0RpZiA+IC01ICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdEVsLnN0eWxlLnRvcCA9IGxpc3RQb3MueSArIHRleHRIZWlnaHQgKyAxMCAtIGVsLnNjcm9sbFRvcCArIHBvc0RpZiArICdweCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKGNhY2hlLmhhcyhyZXN1bHRDYWNoZSwgdikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjZWl2ZUNvbXBsZXRpb25zKGNhY2hlLmdldChyZXN1bHRDYWNoZSwgdikpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgaGFuZGxlcnNTZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdzZWxlY3RbbmFtZT1cImhhbmRsZXJfaWRcIl0nKTtcbiAgICAgICAgICAgIGxldCBjb21wbGV0aW9ucyA9IFtdO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhhbmRsZXJzU2VsZWN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbGV0IG9wdGlvbnMgPSBoYW5kbGVyc1NlbGVjdFtpXS5vcHRpb25zO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgb3B0aW9ucy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9ucy5wdXNoKG9wdGlvbnNbal0udGV4dENvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29tcGxldGlvbnMgPSBjb21wbGV0aW9ucy5maWx0ZXIoZnVuY3Rpb24gKGhhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlciAhPT0gXCJbTXlzZWxmXVwiICYmIGhhbmRsZXIgIT09IFwiW1JlcG9ydGVyXVwiO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGZpbHRlclVzZXJzQnlTdHJpbmcodiwgY29tcGxldGlvbnMpXG5cblxuICAgICAgICAgICAgZnVuY3Rpb24gZmlsdGVyVXNlcnNCeVN0cmluZyh2LCB1c2Vycykge1xuXG4gICAgICAgICAgICAgICAgbGV0IGZpbHRlcmVkVXNlcnMgPSB1c2Vycy5maWx0ZXIoZnVuY3Rpb24gKHVzZXIpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodXNlci5yZXBsYWNlKC8uKlxccy8sIFwiXCIpLmluZGV4T2YodikgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyLmluY2x1ZGVzKHYpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXN1bHRDYWNoZSA9IGNhY2hlLnNldChyZXN1bHRDYWNoZSwgdiwgZmlsdGVyZWRVc2Vycyk7XG4gICAgICAgICAgICAgICAgcmVjZWl2ZUNvbXBsZXRpb25zKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XG4gICAgICAgIGlmICghYXV0b2NvbXBsZXRpbmcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHN3aXRjaCAoZS5jb2RlKSB7XG4gICAgICAgICAgICBjYXNlICdBcnJvd0Rvd24nOlxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsgLy8gcHJldmVudCBzY3JvbGxpbmdcbiAgICAgICAgICAgICAgICBmb2N1c0F1dG9jb21wbGV0ZUxpc3QoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ0Fycm93VXAnOlxuICAgICAgICAgICAgICAgIHN0b3BBdXRvY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ0Fycm93TGVmdCc6XG4gICAgICAgICAgICBjYXNlICdBcnJvd1JpZ2h0JzpcbiAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUgdGhhdCBlbGVtZW50IGhhcyBjb3JyZWN0IHNlbGVjdGlvblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gaGFuZGxlQ2hhbmdlKCksIDApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSdUYWInOiB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGlmICghYXV0b2NvbXBsZXRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb2N1c0F1dG9jb21wbGV0ZUxpc3QoKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGxlbiA9IGdldFNlbGVjdGlvbkxlbmd0aCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0Q2hpbGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjaW1hdGljQXV0b2NvbXBsZXRlV2lkZ2V0JykuZmlyc3RDaGlsZDtcblxuICAgICAgICAgICAgICAgIGlmIChmaXJzdENoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSByb2xlIGljb25cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dFZhbHVlID0gZmlyc3RDaGlsZC50ZXh0Q29udGVudC5yZXBsYWNlKC8uKlxccy8sIFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICA7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVpcmVkU2VsID0gc3RhcnRTZWwgKyBsZW47XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VUbyA9IHN0YXJ0U2VsICsgZ2V0U2VsZWN0aW9uKCkubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgICAgIGVsLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIGVsLnNldFJhbmdlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRWYWx1ZS5zdWJzdHIobGVuKSArICcgJywgLy8gJyAnIHdoaXRlc3BhY2UgYWZ0ZXIgaW5zZXJ0ZWQgQHVzZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkU2VsLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZVRvLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2VuZCdcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VBdXRvY29tcGxldGVMaXN0RWwoKTtcblxuICAgICAgICAgICAgICAgICAgICBhdXRvY29tcGxldGluZyA9IGZhbHNlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlLmNvZGUgPT09ICdBcnJvd0Rvd24nKSB7XG4gICAgICAgICAgICBmb2N1c0F1dG9jb21wbGV0ZUxpc3QoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGUpID0+IHtcbiAgICAgICAgaGFuZGxlQ2hhbmdlKCk7XG4gICAgfSk7XG59XG5cblxuZG9jdW1lbnRcbiAgICAucXVlcnlTZWxlY3RvckFsbChcbiAgICAgICAgJyNidWdub3RlX3RleHQsICNkZXNjcmlwdGlvbiwgI3N0ZXBzX3RvX3JlcHJvZHVjZSwgI2FkZGl0aW9uYWxfaW5mbywgI3N1bW1hcnksICNhZGRpdGlvbmFsX2luZm9ybWF0aW9uJ1xuICAgIClcbiAgICAuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgICAgYXV0b2NvbXBsZXRlKGVsKTtcbiAgICB9KTsiLCIvKipcbiAqIEBwYXJhbSB7Q1NTU3R5bGVEZWNsYXJhdGlvbn0gY29tcHV0ZWRTdHlsZVxuICogQHBhcmFtIHtzdHJpbmd9IHRleHRcbiAqXG4gKiBAcmV0dXJucyB7e3dpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyfX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRleHRTaXplKGNvbXB1dGVkU3R5bGUsIHRleHQpIHtcbiAgICBjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIHNwYW4udGV4dENvbnRlbnQgPSB0ZXh0O1xuXG4gICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZGl2LmFwcGVuZENoaWxkKHNwYW4pO1xuICAgIEFycmF5LmZyb20oY29tcHV0ZWRTdHlsZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIGRpdi5zdHlsZS5zZXRQcm9wZXJ0eShcbiAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgIGNvbXB1dGVkU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShrZXkpLFxuICAgICAgICAgICAgY29tcHV0ZWRTdHlsZS5nZXRQcm9wZXJ0eVByaW9yaXR5KGtleSlcbiAgICAgICAgKTtcbiAgICB9KTtcbiAgICBkaXYuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZGl2KTtcblxuICAgIGNvbnN0IGRhdGEgPSB7d2lkdGg6IHNwYW4ub2Zmc2V0V2lkdGgsIGhlaWdodDogc3Bhbi5vZmZzZXRIZWlnaHR9O1xuXG4gICAgZGl2LnJlbW92ZSgpO1xuXG4gICAgcmV0dXJuIGRhdGE7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9