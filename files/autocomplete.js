!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function o(e,t){return e[t]}n.r(t);let r={};let i;function l(){const e=document.querySelector("#imaticAutocompleteWidget");e&&(i(),e.remove())}function c(){const e=document.querySelector("#imaticAutocompleteWidget");e&&e.focus()}function u(e){let t=!1,n=0,u=null;function s(){t&&(t=!1,l())}function d(){return e.selectionStart-n}function a(){const t=d(),o=e.value.substr(n,t);return 0===o.length||null!=o.match(/[\n ]/)?null:o}const f=()=>{if(0!==e.selectionStart){if("@"===e.value[e.selectionStart-1])return t=!0,n=e.selectionStart,void(u=null);if(t){const c=a();if(null==c)return void s();const f=()=>{const c=function(e,t){for(let n=t.length;n>0;n--){const r=o(e,t.substr(0,n));if(null!=r)return r}}(r,a());if(null==c||0===c.length||!t)return l(),void(u=null);if(function(e,t){if(null==e||null==t)return null==e&&null==t;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(u,c))return;const s=d();u=c,function({completions:e,onSelect:t,focusInput:n,onRestyle:o,input:r}){l();let c=0;const u=e.map(e=>{const t=document.createTextNode(e),n=document.createElement("li");return n.setAttribute("tabindex",-1),n.appendChild(t),n}),s=document.createElement("ul");s.className="imatic-autocomplete",s.setAttribute("id","imaticAutocompleteWidget"),s.setAttribute("tabindex",-1),u.forEach(e=>s.appendChild(e));const d=new Set(["ArrowDown","ArrowUp","Enter"]);s.addEventListener("keydown",o=>{if(d.has(o.code))switch(o.preventDefault(),o.code){case"ArrowUp":{const e=s.querySelector(`li:nth-child(${c})`);e?(c--,e.focus()):n();break}case"ArrowDown":{const e=s.querySelector(`li:nth-child(${c+2})`);e&&(c++,e.focus())}break;case"Enter":if(t){const n=e[c].replace(/.*\s/,"");t({val:n}),l()}}}),s.addEventListener("focus",e=>{const t=s.querySelector("li");c=0,t&&t.focus()});const a=()=>o(s),f=e=>{e.target===r||e.target===s||s.contains(e.target)||l()},p=r.closest(".table-responsive");window.addEventListener("scroll",a),window.addEventListener("resize",a),r.addEventListener("scroll",a),p&&p.addEventListener("scroll",a),window.addEventListener("click",f),window.addEventListener("focusin",f),i=()=>{window.removeEventListener("scroll",a),window.removeEventListener("resize",a),r.removeEventListener("scroll",a),p&&p.removeEventListener("scroll",a),window.removeEventListener("click",f),window.removeEventListener("focusin",f)},document.body.appendChild(s),a()}({completions:c,input:e,focusInput:()=>{const t=n+s;e.focus(),e.setSelectionRange(t,t)},onSelect:({val:o})=>{if(!t)return;const r=n+s,i=n+a().length;e.focus(),e.setRangeText(o.substr(s)+" ",r,i,"end")},onRestyle:t=>{const n=e.getBoundingClientRect(),o=function(e,t){const n=document.createElement("span");n.textContent=t;const o=document.createElement("div");o.appendChild(n),Array.from(e).forEach((function(t){o.style.setProperty(t,e.getPropertyValue(t),e.getPropertyPriority(t))})),o.style.visibility="hidden",document.body.appendChild(o);const r={width:n.offsetWidth,height:n.offsetHeight};return o.remove(),r}(getComputedStyle(e),e.value.substr(0,e.selectionStart)).height;t.style.position="fixed",t.style.left=Math.max(0,n.x)+"px",t.style.top=n.y+o+5-e.scrollTop+"px",t.style.width=e.clientWidth+"px"}})};if(null!=o(r,c))return f(o(r,c));let p=document.querySelectorAll('select[name="handler_id"]'),m=[];for(let e=0;e<p.length;e++){let t=p[e].options;for(let e=0;e<t.length;e++)m.push(t[e].textContent)}m=m.filter((function(e){return"[Myself]"!==e&&"[Reporter]"!==e})),function(e,t){let n=t.filter((function(t){if(0===t.replace(/.*\s/,"").indexOf(e))return t.includes(e)}));r=function(e,t,n){return Object.assign({},e,{[t]:n})}(r,e,n),f()}(c,m)}}else s()};e.addEventListener("keydown",e=>{if(t){switch(e.code){case"ArrowDown":e.preventDefault(),c();break;case"ArrowUp":s();break;case"ArrowLeft":case"ArrowRight":setTimeout(()=>f(),0)}"ArrowDown"===e.code&&c()}}),e.addEventListener("input",e=>{f()})}document.querySelectorAll("#bugnote_text, #description, #steps_to_reproduce, #additional_info, #summary, #additional_information").forEach(e=>{u(e)})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vanMvY2FjaGUuanMiLCJ3ZWJwYWNrOi8vLy4vanMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vanMvdXRpbHMuanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJjYWNoZSIsInRlcm0iLCJyZXN1bHRDYWNoZSIsImRlc3Ryb3lMaXN0Rm4iLCJjbG9zZUF1dG9jb21wbGV0ZUxpc3RFbCIsImVsIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicmVtb3ZlIiwiZm9jdXNBdXRvY29tcGxldGVMaXN0IiwiZm9jdXMiLCJhdXRvY29tcGxldGUiLCJhdXRvY29tcGxldGluZyIsInN0YXJ0U2VsIiwiYWN0aXZlQ29tcGxldGlvbnMiLCJzdG9wQXV0b2NvbXBsZXRlIiwiZ2V0U2VsZWN0aW9uTGVuZ3RoIiwic2VsZWN0aW9uU3RhcnQiLCJnZXRTZWxlY3Rpb24iLCJsZW4iLCJzZWxlY3Rpb24iLCJzdWJzdHIiLCJsZW5ndGgiLCJtYXRjaCIsImhhbmRsZUNoYW5nZSIsInYiLCJyZWNlaXZlQ29tcGxldGlvbnMiLCJjb21wbGV0aW9ucyIsInJlcyIsInYxIiwidjIiLCJmbGF0QXJyYXlzRXF1YWwiLCJvblNlbGVjdCIsImZvY3VzSW5wdXQiLCJvblJlc3R5bGUiLCJpbnB1dCIsImZvY3VzZWQiLCJjb21wbGV0aW9uRWxzIiwibWFwIiwidGV4dCIsImNyZWF0ZVRleHROb2RlIiwibGkiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiYXBwZW5kQ2hpbGQiLCJ1bCIsImNsYXNzTmFtZSIsImZvckVhY2giLCJjb250cm9sS2V5cyIsIlNldCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiaGFzIiwiY29kZSIsInByZXZlbnREZWZhdWx0IiwibmV3QWN0aXZlIiwibmFtZVdpdGhvdXRJY29uIiwicmVwbGFjZSIsInZhbCIsImZpcnN0TGkiLCJyZXN0eWxlIiwiY2xvc2VJZk91dHNpZGVUYXJnZXQiLCJ0YXJnZXQiLCJjb250YWlucyIsInNjQ29udGFpbmVyIiwiY2xvc2VzdCIsIndpbmRvdyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJib2R5Iiwib3BlbkF1dG9jb21wbGV0ZUxpc3RFbCIsInJlcXVpcmVkU2VsIiwic2V0U2VsZWN0aW9uUmFuZ2UiLCJyZXBsYWNlVG8iLCJzZXRSYW5nZVRleHQiLCJsaXN0RWwiLCJsaXN0UG9zIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwidGV4dEhlaWdodCIsImNvbXB1dGVkU3R5bGUiLCJzcGFuIiwidGV4dENvbnRlbnQiLCJkaXYiLCJBcnJheSIsImZyb20iLCJzdHlsZSIsInNldFByb3BlcnR5IiwiZ2V0UHJvcGVydHlWYWx1ZSIsImdldFByb3BlcnR5UHJpb3JpdHkiLCJ2aXNpYmlsaXR5IiwiZGF0YSIsIndpZHRoIiwib2Zmc2V0V2lkdGgiLCJoZWlnaHQiLCJvZmZzZXRIZWlnaHQiLCJnZXRDb21wdXRlZFN0eWxlIiwicG9zaXRpb24iLCJsZWZ0IiwiTWF0aCIsIm1heCIsIngiLCJ0b3AiLCJ5Iiwic2Nyb2xsVG9wIiwiY2xpZW50V2lkdGgiLCJoYW5kbGVyc1NlbGVjdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJvcHRpb25zIiwiaiIsInB1c2giLCJmaWx0ZXIiLCJoYW5kbGVyIiwidXNlcnMiLCJmaWx0ZXJlZFVzZXJzIiwidXNlciIsImluZGV4T2YiLCJpbmNsdWRlcyIsImFzc2lnbiIsImZpbHRlclVzZXJzQnlTdHJpbmciLCJzZXRUaW1lb3V0Il0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdBQXNCQSxHQUFTQSxFQUFNRyxXQUFZLE9BQU9ILEVBQ2hGLElBQUlJLEVBQUtYLE9BQU9ZLE9BQU8sTUFHdkIsR0FGQTFCLEVBQW9Ca0IsRUFBRU8sR0FDdEJYLE9BQU9DLGVBQWVVLEVBQUksVUFBVyxDQUFFVCxZQUFZLEVBQU1LLE1BQU9BLElBQ3RE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QUFPLEdBQUlwSCxFQUFPLENBQUMsQ0FBQ0MsR0FBT2hCLElDd1NmLENBQVVpQixFQUFhdUIsRUFBR3VGLEdBQ3hDdEYsSUFiSjJGLENBQW9CNUYsRUFBR0UsU0FwR3ZCWixLQXNIUlYsRUFBRzZDLGlCQUFpQixVQUFZQyxJQUM1QixHQUFLdkMsRUFBTCxDQUlBLE9BQVF1QyxFQUFFRSxNQUNOLElBQUssWUFDREYsRUFBRUcsaUJBQ0Y3QyxJQUNBLE1BQ0osSUFBSyxVQUNETSxJQUNBLE1BQ0osSUFBSyxZQUNMLElBQUssYUFFRHVHLFdBQVcsSUFBTTlGLElBQWdCLEdBRzFCLGNBQVgyQixFQUFFRSxNQUNGNUMsT0FHUkosRUFBRzZDLGlCQUFpQixRQUFVQyxJQUMxQjNCLE1BS1JsQixTQUNLbUcsaUJBQ0cseUdBRUgxRCxRQUFTMUMsSUFDTk0sRUFBYU4iLCJmaWxlIjoiYXV0b2NvbXBsZXRlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZSgpIHtcbiAgICByZXR1cm4ge307XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXQoY2FjaGUsIHRlcm0sIHZhbHVlKSB7XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGNhY2hlLCB7W3Rlcm1dOiB2YWx1ZX0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0KGNhY2hlLCB0ZXJtKSB7XG4gICAgcmV0dXJuIGNhY2hlW3Rlcm1dO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzKGNhY2hlLCB0ZXJtKSB7XG4gICAgcmV0dXJuIGdldChjYWNoZSwgdGVybSkgIT0gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEJlc3RNYXRjaChjYWNoZSwgdGVybSkge1xuICAgIGZvciAobGV0IGkgPSB0ZXJtLmxlbmd0aDsgaSA+IDA7IGktLSkge1xuICAgICAgICBjb25zdCByZXMgPSBnZXQoY2FjaGUsIHRlcm0uc3Vic3RyKDAsIGkpKTtcbiAgICAgICAgaWYgKHJlcyAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0ICogYXMgdSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCAqIGFzIGNhY2hlIGZyb20gJy4vY2FjaGUnO1xuXG5sZXQgcmVzdWx0Q2FjaGUgPSBjYWNoZS5jcmVhdGUoKTtcbmNvbnN0IG1heF9sZW4gPSAxOTE7XG5sZXQgZGVzdHJveUxpc3RGbjtcblxuZnVuY3Rpb24gZmxhdEFycmF5c0VxdWFsKHYxLCB2Mikge1xuICAgIGlmICh2MSA9PSBudWxsIHx8IHYyID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHYxID09IG51bGwgJiYgdjIgPT0gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAodjEubGVuZ3RoICE9PSB2Mi5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdjEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHYxW2ldICE9PSB2MltpXSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIG9wZW5BdXRvY29tcGxldGVMaXN0RWwoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxldGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblNlbGVjdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzSW5wdXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblJlc3R5bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkge1xuICAgIGNsb3NlQXV0b2NvbXBsZXRlTGlzdEVsKCk7XG5cbiAgICBsZXQgZm9jdXNlZCA9IDA7XG5cbiAgICBjb25zdCBjb21wbGV0aW9uRWxzID0gY29tcGxldGlvbnMubWFwKCh2KSA9PiB7XG4gICAgICAgIGNvbnN0IHRleHQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh2KTtcblxuICAgICAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgIGxpLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAtMSk7XG4gICAgICAgIGxpLmFwcGVuZENoaWxkKHRleHQpO1xuXG4gICAgICAgIHJldHVybiBsaTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcbiAgICB1bC5jbGFzc05hbWUgPSAnaW1hdGljLWF1dG9jb21wbGV0ZSc7XG4gICAgdWwuc2V0QXR0cmlidXRlKCdpZCcsICdpbWF0aWNBdXRvY29tcGxldGVXaWRnZXQnKTtcbiAgICB1bC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgLTEpO1xuICAgIGNvbXBsZXRpb25FbHMuZm9yRWFjaCgoZWwpID0+IHVsLmFwcGVuZENoaWxkKGVsKSk7XG5cbiAgICBjb25zdCBjb250cm9sS2V5cyA9IG5ldyBTZXQoWydBcnJvd0Rvd24nLCAnQXJyb3dVcCcsICdFbnRlciddKTtcblxuICAgIHVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4ge1xuICAgICAgICBpZiAoIWNvbnRyb2xLZXlzLmhhcyhlLmNvZGUpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7IC8vIHByZXZlbnQgc2Nyb2xsaW5nXG5cbiAgICAgICAgc3dpdGNoIChlLmNvZGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ0Fycm93VXAnOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3QWN0aXZlID0gdWwucXVlcnlTZWxlY3RvcihgbGk6bnRoLWNoaWxkKCR7Zm9jdXNlZH0pYCk7XG4gICAgICAgICAgICAgICAgaWYgKG5ld0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICBmb2N1c2VkLS07XG4gICAgICAgICAgICAgICAgICAgIG5ld0FjdGl2ZS5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvY3VzSW5wdXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdBcnJvd0Rvd24nOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3QWN0aXZlID0gdWwucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgICAgICAgYGxpOm50aC1jaGlsZCgke2ZvY3VzZWQgKyAyfSlgXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBpZiAobmV3QWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvY3VzZWQrKztcbiAgICAgICAgICAgICAgICAgICAgbmV3QWN0aXZlLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnRW50ZXInOiB7XG4gICAgICAgICAgICAgICAgaWYgKG9uU2VsZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHJlbW92ZUljb25Gcm9tTmFtZShuYW1lV2l0aEljb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuYW1lV2l0aEljb24ucmVwbGFjZSgvLipcXHMvLCBcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZVdpdGhvdXRJY29uID0gcmVtb3ZlSWNvbkZyb21OYW1lKGNvbXBsZXRpb25zW2ZvY3VzZWRdKTtcbiAgICAgICAgICAgICAgICAgICAgICBvblNlbGVjdCh7dmFsOiBuYW1lV2l0aG91dEljb259KTtcbiAgICAgICAgICAgICAgICAgICAgICBjbG9zZUF1dG9jb21wbGV0ZUxpc3RFbCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgdWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCAoZSkgPT4ge1xuICAgICAgICBjb25zdCBmaXJzdExpID0gdWwucXVlcnlTZWxlY3RvcignbGknKTtcbiAgICAgICAgZm9jdXNlZCA9IDA7XG4gICAgICAgIGlmIChmaXJzdExpKSB7XG4gICAgICAgICAgICBmaXJzdExpLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3R5bGUgPSAoKSA9PiBvblJlc3R5bGUodWwpO1xuXG4gICAgY29uc3QgY2xvc2VJZk91dHNpZGVUYXJnZXQgPSAoZSkgPT4ge1xuICAgICAgICBpZiAoZS50YXJnZXQgPT09IGlucHV0IHx8IGUudGFyZ2V0ID09PSB1bCB8fCB1bC5jb250YWlucyhlLnRhcmdldCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNsb3NlQXV0b2NvbXBsZXRlTGlzdEVsKCk7XG4gICAgfTtcblxuICAgIGNvbnN0IHNjQ29udGFpbmVyID0gaW5wdXQuY2xvc2VzdCgnLnRhYmxlLXJlc3BvbnNpdmUnKTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCByZXN0eWxlKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgcmVzdHlsZSk7XG4gICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgcmVzdHlsZSk7XG4gICAgaWYgKHNjQ29udGFpbmVyKSB7XG4gICAgICAgIHNjQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHJlc3R5bGUpO1xuICAgIH1cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZUlmT3V0c2lkZVRhcmdldCk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCBjbG9zZUlmT3V0c2lkZVRhcmdldCk7XG5cbiAgICBkZXN0cm95TGlzdEZuID0gKCkgPT4ge1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgcmVzdHlsZSk7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXN0eWxlKTtcbiAgICAgICAgaW5wdXQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgcmVzdHlsZSk7XG4gICAgICAgIGlmIChzY0NvbnRhaW5lcikge1xuICAgICAgICAgICAgc2NDb250YWluZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgcmVzdHlsZSk7XG4gICAgICAgIH1cbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VJZk91dHNpZGVUYXJnZXQpO1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignZm9jdXNpbicsIGNsb3NlSWZPdXRzaWRlVGFyZ2V0KTtcbiAgICB9O1xuXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh1bCk7XG5cbiAgICByZXN0eWxlKCk7XG59XG5cbmZ1bmN0aW9uIGNsb3NlQXV0b2NvbXBsZXRlTGlzdEVsKCkge1xuICAgIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2ltYXRpY0F1dG9jb21wbGV0ZVdpZGdldCcpO1xuICAgIGlmIChlbCkge1xuICAgICAgICBkZXN0cm95TGlzdEZuKCk7XG4gICAgICAgIGVsLnJlbW92ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZm9jdXNBdXRvY29tcGxldGVMaXN0KCkge1xuICAgIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2ltYXRpY0F1dG9jb21wbGV0ZVdpZGdldCcpO1xuICAgIGlmICghZWwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGVsLmZvY3VzKCk7XG59XG5cbmZ1bmN0aW9uIGF1dG9jb21wbGV0ZShlbCkge1xuICAgIGxldCBhdXRvY29tcGxldGluZyA9IGZhbHNlO1xuICAgIGxldCBzdGFydFNlbCA9IDA7XG4gICAgbGV0IGFjdGl2ZUNvbXBsZXRpb25zID0gbnVsbDtcblxuICAgIGZ1bmN0aW9uIHN0b3BBdXRvY29tcGxldGUoKSB7XG4gICAgICAgIGlmICghYXV0b2NvbXBsZXRpbmcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGF1dG9jb21wbGV0aW5nID0gZmFsc2U7XG4gICAgICAgIGNsb3NlQXV0b2NvbXBsZXRlTGlzdEVsKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U2VsZWN0aW9uTGVuZ3RoKCkge1xuICAgICAgICByZXR1cm4gZWwuc2VsZWN0aW9uU3RhcnQgLSBzdGFydFNlbDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRTZWxlY3Rpb24oKSB7XG4gICAgICAgIGNvbnN0IGxlbiA9IGdldFNlbGVjdGlvbkxlbmd0aCgpO1xuICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBlbC52YWx1ZS5zdWJzdHIoc3RhcnRTZWwsIGxlbik7XG5cbiAgICAgICAgaWYgKHNlbGVjdGlvbi5sZW5ndGggPT09IDAgfHwgc2VsZWN0aW9uLm1hdGNoKC9bXFxuIF0vKSAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZWxlY3Rpb247XG4gICAgfVxuXG4gICAgY29uc3QgaGFuZGxlQ2hhbmdlID0gKCkgPT4ge1xuICAgICAgICBpZiAoZWwuc2VsZWN0aW9uU3RhcnQgPT09IDApIHtcbiAgICAgICAgICAgIHN0b3BBdXRvY29tcGxldGUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlbC52YWx1ZVtlbC5zZWxlY3Rpb25TdGFydCAtIDFdID09PSAnQCcpIHtcbiAgICAgICAgICAgIGF1dG9jb21wbGV0aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHN0YXJ0U2VsID0gZWwuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgICAgICBhY3RpdmVDb21wbGV0aW9ucyA9IG51bGw7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYXV0b2NvbXBsZXRpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IHYgPSBnZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIGlmICh2ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBzdG9wQXV0b2NvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCByZWNlaXZlQ29tcGxldGlvbnMgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29tcGxldGlvbnMgPSBjYWNoZS5nZXRCZXN0TWF0Y2goXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdENhY2hlLFxuICAgICAgICAgICAgICAgICAgICBnZXRTZWxlY3Rpb24oKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9ucyA9PSBudWxsIHx8XG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRpb25zLmxlbmd0aCA9PT0gMCB8fFxuICAgICAgICAgICAgICAgICAgICAhYXV0b2NvbXBsZXRpbmdcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VBdXRvY29tcGxldGVMaXN0RWwoKTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlQ29tcGxldGlvbnMgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGZsYXRBcnJheXNFcXVhbChhY3RpdmVDb21wbGV0aW9ucywgY29tcGxldGlvbnMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCBsZW4gPSBnZXRTZWxlY3Rpb25MZW5ndGgoKTtcbiAgICAgICAgICAgICAgICBhY3RpdmVDb21wbGV0aW9ucyA9IGNvbXBsZXRpb25zO1xuXG4gICAgICAgICAgICAgICAgb3BlbkF1dG9jb21wbGV0ZUxpc3RFbCh7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRpb25zOiBjb21wbGV0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQ6IGVsLFxuICAgICAgICAgICAgICAgICAgICBmb2N1c0lucHV0OiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXF1aXJlZFNlbCA9IHN0YXJ0U2VsICsgbGVuO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWwuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLnNldFNlbGVjdGlvblJhbmdlKHJlcXVpcmVkU2VsLCByZXF1aXJlZFNlbCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0OiAoe3ZhbH0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYXV0b2NvbXBsZXRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVpcmVkU2VsID0gc3RhcnRTZWwgKyBsZW47XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXBsYWNlVG8gPSBzdGFydFNlbCArIGdldFNlbGVjdGlvbigpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgZWwuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLnNldFJhbmdlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWwuc3Vic3RyKGxlbikrICcgJywgLy8gJyAnIHdoaXRlc3BhY2UgYWZ0ZXIgaW5zZXJ0ZWQgQHVzZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZFNlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlVG8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2VuZCdcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9uUmVzdHlsZTogKGxpc3RFbCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGlzdFBvcyA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWxTdHlsZXMgPSBnZXRDb21wdXRlZFN0eWxlKGVsKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dEhlaWdodCA9IHUudGV4dFNpemUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxTdHlsZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwudmFsdWUuc3Vic3RyKDAsIGVsLnNlbGVjdGlvblN0YXJ0KVxuICAgICAgICAgICAgICAgICAgICAgICAgKS5oZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RFbC5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0RWwuc3R5bGUubGVmdCA9IE1hdGgubWF4KDAsIGxpc3RQb3MueCkgKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdEVsLnN0eWxlLnRvcCA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdFBvcy55ICsgdGV4dEhlaWdodCArIDUgLSBlbC5zY3JvbGxUb3AgKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdEVsLnN0eWxlLndpZHRoID0gZWwuY2xpZW50V2lkdGggKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKGNhY2hlLmhhcyhyZXN1bHRDYWNoZSwgdikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjZWl2ZUNvbXBsZXRpb25zKGNhY2hlLmdldChyZXN1bHRDYWNoZSwgdikpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgaGFuZGxlcnNTZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdzZWxlY3RbbmFtZT1cImhhbmRsZXJfaWRcIl0nKTtcbiAgICAgICAgICAgIGxldCBjb21wbGV0aW9ucyA9IFtdO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhhbmRsZXJzU2VsZWN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbGV0IG9wdGlvbnMgPSBoYW5kbGVyc1NlbGVjdFtpXS5vcHRpb25zO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgb3B0aW9ucy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9ucy5wdXNoKG9wdGlvbnNbal0udGV4dENvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29tcGxldGlvbnMgPSBjb21wbGV0aW9ucy5maWx0ZXIoZnVuY3Rpb24gKGhhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlciAhPT0gXCJbTXlzZWxmXVwiICYmIGhhbmRsZXIgIT09IFwiW1JlcG9ydGVyXVwiO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGZpbHRlclVzZXJzQnlTdHJpbmcodiwgY29tcGxldGlvbnMpXG5cblxuICAgICAgICAgICAgZnVuY3Rpb24gZmlsdGVyVXNlcnNCeVN0cmluZyh2LCB1c2Vycykge1xuXG4gICAgICAgICAgICAgICAgbGV0IGZpbHRlcmVkVXNlcnMgPSB1c2Vycy5maWx0ZXIoZnVuY3Rpb24gKHVzZXIpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodXNlci5yZXBsYWNlKC8uKlxccy8sIFwiXCIpLmluZGV4T2YodikgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyLmluY2x1ZGVzKHYpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJlc3VsdENhY2hlID0gY2FjaGUuc2V0KHJlc3VsdENhY2hlLCB2LCBmaWx0ZXJlZFVzZXJzKTtcbiAgICAgICAgICAgICAgICByZWNlaXZlQ29tcGxldGlvbnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcbiAgICAgICAgaWYgKCFhdXRvY29tcGxldGluZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgc3dpdGNoIChlLmNvZGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ0Fycm93RG93bic6XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOyAvLyBwcmV2ZW50IHNjcm9sbGluZ1xuICAgICAgICAgICAgICAgIGZvY3VzQXV0b2NvbXBsZXRlTGlzdCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnQXJyb3dVcCc6XG4gICAgICAgICAgICAgICAgc3RvcEF1dG9jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnQXJyb3dMZWZ0JzpcbiAgICAgICAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOlxuICAgICAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB0aGF0IGVsZW1lbnQgaGFzIGNvcnJlY3Qgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBoYW5kbGVDaGFuZ2UoKSwgMCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUuY29kZSA9PT0gJ0Fycm93RG93bicpIHtcbiAgICAgICAgICAgIGZvY3VzQXV0b2NvbXBsZXRlTGlzdCgpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoZSkgPT4ge1xuICAgICAgICBoYW5kbGVDaGFuZ2UoKTtcbiAgICB9KTtcbn1cblxuXG5kb2N1bWVudFxuICAgIC5xdWVyeVNlbGVjdG9yQWxsKFxuICAgICAgICAnI2J1Z25vdGVfdGV4dCwgI2Rlc2NyaXB0aW9uLCAjc3RlcHNfdG9fcmVwcm9kdWNlLCAjYWRkaXRpb25hbF9pbmZvLCAjc3VtbWFyeSwgI2FkZGl0aW9uYWxfaW5mb3JtYXRpb24nXG4gICAgKVxuICAgIC5mb3JFYWNoKChlbCkgPT4ge1xuICAgICAgICBhdXRvY29tcGxldGUoZWwpO1xuICAgIH0pOyIsIi8qKlxuICogQHBhcmFtIHtDU1NTdHlsZURlY2xhcmF0aW9ufSBjb21wdXRlZFN0eWxlXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dFxuICpcbiAqIEByZXR1cm5zIHt7d2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXJ9fVxuICovXG5leHBvcnQgZnVuY3Rpb24gdGV4dFNpemUoY29tcHV0ZWRTdHlsZSwgdGV4dCkge1xuICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgc3Bhbi50ZXh0Q29udGVudCA9IHRleHQ7XG5cbiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBkaXYuYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgQXJyYXkuZnJvbShjb21wdXRlZFN0eWxlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgZGl2LnN0eWxlLnNldFByb3BlcnR5KFxuICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgY29tcHV0ZWRTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKGtleSksXG4gICAgICAgICAgICBjb21wdXRlZFN0eWxlLmdldFByb3BlcnR5UHJpb3JpdHkoa2V5KVxuICAgICAgICApO1xuICAgIH0pO1xuICAgIGRpdi5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkaXYpO1xuXG4gICAgY29uc3QgZGF0YSA9IHt3aWR0aDogc3Bhbi5vZmZzZXRXaWR0aCwgaGVpZ2h0OiBzcGFuLm9mZnNldEhlaWdodH07XG5cbiAgICBkaXYucmVtb3ZlKCk7XG5cbiAgICByZXR1cm4gZGF0YTtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=